tosca_definitions_version: tosca_simple_yaml_1_3

node_types:

  sodalite.data.mover:
    description: >
      Moves data from "src" node to "dst" node
    derived_from: tosca.nodes.Root

  sodalite.data.mover.url:
    description: >
      Moves data from "src" url to "dst" location.
      "dst" can be either absolute path or relative. "dst" is relative to $HOME directory
    derived_from: sodalite.data.mover
    properties:
      src:
        type: "string"
        required: true
      dst:
        type: "string"
        required: true
    requirements:
      - host:
          node: tosca.nodes.Compute
          capability: tosca.capabilities.Compute
          relationship: tosca.relationships.HostedOn
    interfaces:
      Standard:
        type: tosca.interfaces.node.lifecycle.Standard
        operations:
          create:
            inputs:
              remote_host_public_address: { default: { get_attribute: [SELF, host, public_address] } }
              remote_host_username: { default: { get_attribute: [SELF, host, username] } }
              remote_host_keypath: { default: { get_attribute: [SELF, host, ssh-key] } }
              src: { default: { get_property: [SELF, src] } }
              dst: { default: { get_property: [SELF, dst] } }
            implementation: 
              primary: playbooks/create-url.yml